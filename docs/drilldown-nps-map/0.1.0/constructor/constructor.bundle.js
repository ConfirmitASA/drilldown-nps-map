!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),c=r(i);n(18);var s=function(){function e(){var t=this;return o(this,e),c.default.promiseRequest("maps.json").then(function(e){t.config=JSON.parse(e),t.hm=t.constructor.stubHighcharts(),t.mapsSelector=document.querySelector("#mapsSectionSelector"),t.mapsList=document.querySelector("#mapsList"),t.countriesList=document.querySelector("#countriesList"),t.countriesFilter=document.querySelector("#countriesFilter"),t.mapsFilter=document.querySelector("#mapsFilter"),t.processMap=t.processMap.bind(t),t.createMapSwitcher(),t.initFiltering()})}return a(e,[{key:"initFiltering",value:function(){var e=[this.countriesFilter,this.mapsFilter],t=[this.countriesList,this.mapsList];e.forEach(function(e,n){e.addEventListener("input",function(e){var r=e.target.value,o=t[n];"TABLE"==o.nodeName&&[].slice.call(o.querySelectorAll("tbody>tr>td:nth-child(1)")).forEach(function(e){var t=e.parentNode;e.textContent.toLowerCase().indexOf(r.toLowerCase())>-1?t.style.display="table-row":t.style.display="none"}),"UL"==o.nodeName&&[].slice.call(o.querySelectorAll("li")).forEach(function(e){e.textContent.toLowerCase().indexOf(r.toLowerCase())>-1?e.style.display="block":e.style.display="none"})})})}},{key:"createMapSwitcher",value:function(){var e=this,t=document.querySelector("#mapsSectionSelector");this.config.forEach(function(t,n){var r=document.createElement("option");r.value=n,r.textContent=t.title,e.mapsSelector.appendChild(r)}),this.mapsSelector.addEventListener("change",function(n){e.loadMapsSection(t.value)}),this.loadMapsSection(0)}},{key:"loadMapsSection",value:function(t){var n=this;this.currentSection=this.config[t],this.clearMapsList(),this.currentSection.maps.forEach(function(t,r){var o=e.createElement("li");o.appendChild(n.createRadio(r,t.title)),o.appendChild(n.createLink(r,"demo")),n.mapsList.appendChild(o)})}},{key:"createRadio",value:function(e,t){var n=document.createElement("input");n.type="radio",n.name="map",n.value=e;var r=this.constructor.createElement("label",t);return r.insertBefore(n,r.firstChild),n.addEventListener("change",this.processMap),r}},{key:"createLink",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_blank",o=this.currentSection.maps[t][n],a=e.createElement("a",o.title);return a.href=o.href,a.target=r,a}},{key:"processMap",value:function(e){var t=this,n=this.currentSection.maps[e.target.value],r=this.fakeXHR(n.js.href);r.then(function(e){t.clearCountriesList(),t.constructor.updateCodebox(t.constructor.getMapID(n.js.href)),t.buildCountriesList(e)})}},{key:"buildCountriesList",value:function(t){var n=document.createDocumentFragment();t.features.forEach(function(t){var r=t.properties,o=e.createElement("tr");n.appendChild(o),o.appendChild(e.createElement("td",r.name)),o.appendChild(e.createElement("td",r["hc-key"])),o.appendChild(e.createElement("td",r.subregion)),o.appendChild(e.createElement("td",r["region-wb"]))}),this.countriesList.querySelector("tbody").appendChild(n)}},{key:"clearCountriesList",value:function(){this.countriesList.querySelector("tbody").innerHTML=""}},{key:"fakeXHR",value:function(e){var t=this,n=this.constructor.getMapID(e),r=this.hm;return new Promise(function(o,a){t.hm[n]?o(r[n]):!function(){var t=function e(t){a.removeEventListener("load",e),i.removeChild(a),o(r[n])},a=document.createElement("script"),i=document.querySelector("head");a.addEventListener("load",t),a.src=e,i.appendChild(a)}()})}},{key:"clearMapsList",value:function(){var e=this;this.mapsList.children.length>0&&([].slice.call(this.mapsList.querySelectorAll("input[type=radio]")).forEach(function(t){return t.removeEventListener("change",e.processMap)}),this.mapsList.innerHTML="")}}],[{key:"stubHighcharts",value:function(){return window.Highcharts?window.Highcharts.maps||(window.Highcharts.maps={}):window.Highcharts={maps:{}},window.Highcharts.maps}},{key:"updateCodebox",value:function(e){document.querySelector(".codebox").innerHTML="mapName: "+e}},{key:"createElement",value:function(e,t){var n=document.createElement(e);return t&&(n.textContent=t),n}},{key:"getMapID",value:function(e){return e.split("mapdata/")[1].split(".")[0]}}]),e}();t.default=s,window.Reportal=window.Reportal||{},c.default.mixin(window.Reportal,{MapsConstructor:s}),e.exports=t.default},1:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"mixin",value:function(e,t){for(var n in t)e[n]=t[n];return e}},{key:"_logger",value:function(e,t){switch(1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e].apply(console,t)}}},{key:"_log",value:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("log",e)}},{key:"_warn",value:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("warn",e)}},{key:"_error",value:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("error",e)}},{key:"newEvent",value:function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}},{key:"isNumber",value:function(e){return isNaN(parseFloat(e))?0==e.length?null:e:(e=e.replace(/,/i,""),parseFloat(e))}},{key:"promiseRequest",value:function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onload=function(e){200==r.status?t(r.responseText):n(Error(r.status+": "+r.statusText))},r.onerror=function(e){n(e)},r.send()})}},{key:"getQueryVariable",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.search.substring(1),n=t.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");if(o[0].toLowerCase()==e.toLowerCase())return o[1]}return null}}]),e}();t.default=o,e.exports=t.default},18:function(e,t){}});
//# sourceMappingURL=constructor.bundle.js.map
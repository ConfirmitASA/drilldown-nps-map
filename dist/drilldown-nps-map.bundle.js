!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(13),a=n(o),i=r(1),l=n(i);window.Reportal=window.Reportal||{},l.default.mixin(window.Reportal,{DrilldownMap:a.default,ReportalBase:l.default}),t.default=a.default,e.exports=t.default},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){r(this,e)}return n(e,null,[{key:"mixin",value:function(e,t){for(var r in t)e[r]=t[r];return e}},{key:"_logger",value:function(e,t){switch(1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e].apply(console,t)}}},{key:"_log",value:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("log",e)}},{key:"_warn",value:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("warn",e)}},{key:"_error",value:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("error",e)}},{key:"newEvent",value:function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}},{key:"isNumber",value:function(e){return isNaN(parseFloat(e))?0==e.length?null:e:(e=e.replace(/,/i,""),parseFloat(e))}},{key:"promiseRequest",value:function(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(e){200==n.status?t(n.responseText):r(Error(n.status+": "+n.statusText))},n.onerror=function(e){r(e)},n.send()})}},{key:"getQueryVariable",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.search.substring(1),r=t.split("&"),n=0;n<r.length;n++){var o=r[n].split("=");if(o[0].toLowerCase()==e.toLowerCase())return o[1]}return null}}]),e}();t.default=o,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(1),u=n(l),s=function(){function e(){o(this,e)}return i(e,null,[{key:"detectMultidimensional",value:function(e){var t=!1,r=e.parentNode.querySelectorAll("table#"+e.id+">tbody>tr>td:nth-child(1)[rowspan]");return r.length>0&&(t=!0,[].slice.call(r).forEach(function(e){e.classList.add("blockCell"),e.parentNode.classList.add("firstInBlock")})),t}},{key:"prepareDataCell",value:function(e,t,r){return u.default.isNumber(e.textContent.trim())}},{key:"getData",value:function(e){var t=this,r=e.source,n=e.excludeBlock,o=void 0===n||n,i=e.excludeColumns,l=e.excludeRows,u=e.direction,s=void 0===u?"row":u,c=e.multidimensional,f=void 0!==c&&c,d=[];if(!r||"TABLE"!=r.tagName)throw new TypeError("source must be defined and be a table");return!function(){var e=[].slice.call(r.parentNode.querySelectorAll("table#"+r.id+">tbody>tr"));if(!(e.length>0))throw new Error("table#"+r.id+"'s body must contain rows");!function(){var r=[];void 0!=("undefined"==typeof l?"undefined":a(l))&&("number"==typeof l&&(l<0&&(l=e.length+l),e.splice(l,1)),Array.isArray(l)&&(l.sort(function(e,t){return e>t?1:-1}).reverse(),l.forEach(function(t){t>=0?e.splice(t,1):e.splice(e.length+t,1)}))),e.forEach(function(e,n){f&&e.classList.contains("firstInBlock")&&(Array.isArray(r)&&r.length>0&&d.push(r),r=[]),"row"!=s||Array.isArray(r[r.length])||(r[r.length]=[]);var l=[].slice.call(e.children),u=i;void 0!=("undefined"==typeof u?"undefined":a(u))&&("number"==typeof u&&(f&&!e.classList.contains("firstInBlock")&&!u<0&&(u+=1),u<0&&(u=l.length+u),l.splice(u,1)),Array.isArray(u)&&(u.sort(function(e,t){return e>t?1:-1}).reverse(),u.forEach(function(t){t>=0?l.splice(f&&!e.classList.contains("firstInBlock")?t+1:t,1):l.splice(l.length+t,1)}))),l.forEach(function(a,i){if("string"==typeof s&&"row"==s)f&&o&&a.rowSpan>1||r[r.length-1].push(t.prepareDataCell(a,n,i));else{if("string"!=typeof s||"column"!=s)throw new TypeError("direction has tobe a String==`row | column`, not a ${direction}");var l=i;f&&o&&a.rowSpan>1||(l+=e.classList.contains("firstInBlock")?-1:0,Array.isArray(r[l])||(r[l]=[]),r[l].push(t.prepareDataCell(a,n,l)))}})}),f&&Array.isArray(r)&&r.length>0?d.push(r):d=r}()}(),d}}]),e}();t.default=s,e.exports=t.default},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.row,o=t.id,a=void 0===o?null:o,i=t.nameCell,l=t.name,u=t.block,s=void 0===u?null:u;r(this,e),this.row=n,this.id=a,this.nameCell=i,this.name=l||i.textContent.trim(),this.block=s,this.firstInBlock=null!=s&&this.row.rowIndex===this.block.cell.parentNode.rowIndex};t.default=n,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(2),c=n(s),f=r(1),d=n(f),p=r(10),h=n(p),y=r(8),m=n(y),v=r(12),b=n(v),g=(r(16),r(15),function(e){function t(e){o(this,t);var r=e.source,n=(e.rowheaderColumnIndex,e.defaultHeaderRow),i=e.dataStripDirection,u=e.excludeBlock,s=e.excludeColumns,c=e.excludeRows,f=e.sorting,d=e.floatingHeader,p=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));p.source=r;var y=void 0;return d&&"object"==("undefined"==typeof d?"undefined":l(d))&&(p.floatingHeader=new b.default(r),p.refSource=y=p.floatingHeader.header),p.multidimensional=p.constructor.detectMultidimensional(r),p.data=p.constructor.getData({source:r,refSource:y,defaultHeaderRow:n,excludeBlock:u,excludeColumns:s,excludeRows:c,direction:i,multidimensional:p.multidimensional}),f&&"object"==("undefined"==typeof f?"undefined":l(f))&&!function(){var e=function(e){return p.constructor.reorderRows(p.data,p.source,p.multidimensional)};[r,y].forEach(function(t){t&&t.addEventListener("reportal-table-sort",e)}),f.source=r,f.refSource=y,f.defaultHeaderRow=n,f.data=p.data,f.multidimensional=p.multidimensional,p.sorting=new m.default(f)}(),p.columns=p.sorting&&p.sorting.columns?p.sorting.columns:new h.default({source:r,refSource:y,defaultHeaderRow:n}),p}return i(t,e),u(t,null,[{key:"prepareDataCell",value:function(e,t,r){return{cell:e,data:d.default.isNumber(e.textContent.trim()),columnIndex:r,rowIndex:t}}},{key:"reorderRows",value:function(e,r,n){var o=document.createDocumentFragment();t.dimensionalDataIterator(e,n,function(e){n&&t.repositionBlockCell(e),e.forEach(function(e){o.appendChild(e[0].cell.parentNode)})}),r.querySelector("tbody").appendChild(o)}},{key:"repositionBlockCell",value:function(e){var t=e.filter(function(e){return e[0].cell.parentNode.classList.contains("firstInBlock")})[0],r=t[0].cell.parentNode;if(0!=e.indexOf(t)){var n=e[0][0].cell.parentNode;n.insertBefore(r.querySelector(".blockCell"),n.firstElementChild),n.classList.add("firstInBlock"),r.classList.remove("firstInBlock")}}},{key:"dimensionalDataIterator",value:function(e,t,r){if(!r||"function"!=typeof r)throw new TypeError("`callback` must be passed and be a function");return t?void e.forEach(function(e,t){r(e,t)}):r(e)}}]),t}(c.default));t.default=g,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=n(o),i=r(4),l=n(i),u=r(1),s=n(u),c=r(3),f=n(c);window.Reportal=window.Reportal||{},s.default.mixin(window.Reportal,{TableData:a.default,AggregatedTable:l.default,AggregatedTableRowMeta:f.default}),t.default=l.default,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),l=n(i),u=function(){function e(){o(this,e)}return a(e,null,[{key:"fetchChildHierarchy",value:function(t,r,n,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:9,i=[location.origin,"reportal","Hierarchy",l.default.getQueryVariable("ReportId"),r,a,"GetChildNodes"],u=["nodeId="+t,"info="+e.encode({IsPreview:"true"===l.default.getQueryVariable("Preview"),HierarchyControlId:n}),"isRepBase=false","parameter=","PageStateId="+o],s=l.default.promiseRequest([i.join("/"),"?",u.join("&")].join(""));return s.then(function(e){return Promise.resolve(JSON.parse(e))})}},{key:"fetchChildTable",value:function(t,r,n,o){r=null!=r?r:t;var a=[location.origin,"reportal","Report",l.default.getQueryVariable("ReportId"),"Component",n],i=["PageId="+l.default.getQueryVariable("PageId"),"Preview="+l.default.getQueryVariable("Preview"),"PageStateId="+o,"pageFilters="+e.encode({}),"customFilters="+e.encode({}),"persNodes="+e.encode([{NodeId:t,Text:null}]),"origNodes="+e.encode([{NodeId:r,Text:null}])],u=l.default.promiseRequest([a.join("/"),"?",i.join("&")].join(""));return u.then(function(e){var t=document.createElement("span");return t.innerHTML=e,Promise.resolve(t.querySelector("table"))})}},{key:"stripRowsFromResponseTable",value:function(e,t){var r=[].slice.call(e.querySelectorAll("tbody>tr"));return t&&t.length>0&&t.reverse().forEach(function(e){r.splice(e,1)}),r}},{key:"encode",value:function(e){return encodeURIComponent(JSON.stringify(e))}}]),e}();t.default=u,window.Reportal=window.Reportal||{},l.default.mixin(window.Reportal,{AsyncHierarchyTable:u}),e.exports=t.default},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){var o=this;r(this,e);var a=t.columns,i=t.sortCallback,l=t.defaultSorting,u=void 0===l?[]:l,s=t.sortCallbackScope,c=void 0===s?this:s;if(this.sortOrder=[],void 0==("undefined"==typeof a?"undefined":n(a))||null==a)throw new TypeError("SortOrder: columns must be specified");this.columns=a,this.sort=function(){i&&"function"==typeof i&&i.call(c,o)},u.length>0&&(u.forEach(function(e){return o.add(e)}),this.sort())}return o(e,[{key:"getCell",value:function(e){if("undefined"!=typeof e&&null!=e){var t=[];return this.columns[e].cell&&t.push(this.columns[e].cell),this.columns[e].refCell&&t.push(this.columns[e].refCell),t}throw new TypeError("columnIndex parameter should not be null")}},{key:"add",value:function(e){this.getCell(e.column).forEach(function(t){["sorted",e.direction].forEach(function(e){return t.classList.add(e)})}),this.sortOrder.push(e)}},{key:"remove",value:function(e,t){var r=this;["sorted","asc","desc"].forEach(function(t){r.getCell(e).forEach(function(e){return e.classList.remove(t)})}),this.sortOrder.splice(t,1)}},{key:"replace",value:function(e){var t=this;this.sortOrder.length>0&&this.sortOrder.forEach(function(e,r){t.remove(e.column,r)}),this.add(e),this.sort()}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return Array.isArray(e)?e:Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(1),s=n(u),c=r(9),f=n(c),d=r(7),p=n(d),h=function(){function e(t){var r,n,i=this;a(this,e);var l=t.source,u=t.refSource,c=t.defaultHeaderRow,d=void 0===c?-1:c,h=t.included,y=t.excluded,m=t.defaultSorting,v=void 0===m?[]:m,b=t.data,g=void 0===b?[]:b,w=t.multidimensional,k=void 0!==w&&w;if(this._sortEvent=s.default.newEvent("reportal-table-sort"),!l)throw new Error("`source` table is not specified for SortTable");this.source=l,this.data=g,this.multidimensional=k;var S=e.defineSortableColumns(new f.default({source:l,refSource:u,defaultHeaderRow:d}),h,y);this.columns=S,this.sortOrder=(r=new p.default({columns:S,sortCallback:this.sort,sortCallbackScope:this,defaultSorting:v}),n=o(r.sortOrder),r),[l,u].forEach(function(t){t&&e.listenForSort(f.default.getHeader(t),S,i.sortOrder)})}return l(e,[{key:"sort",value:function(t){var r=this,n=t.sortOrder||this.sortOrder.sortOrder,o=this.columns;n&&n.length>0&&(this.multidimensional?this.data.forEach(function(t){e.sortDimension(t,r.columns,n)}):e.sortDimension(this.data,o,n),o[n[0].column].cell.dispatchEvent(this._sortEvent))}}],[{key:"defineSortableColumns",value:function(e,t,r){var n=[].slice.call(e);return n.forEach(function(e,n){var o=!t&&!r||t&&t.indexOf(n)!=-1||r&&r.indexOf(n)==-1;o&&(e.cell.classList.add("sortable"),e.refCell&&e.refCell.classList.add("sortable"),e.sortable=!0)}),n}},{key:"listenForSort",value:function(e,t,r){e.addEventListener("click",function(e){for(var n=void 0,o=0;o<t.length;o++)if(e.target==t[o].cell||e.target==t[o].refCell){n=t[o];break}"TD"!=e.target.tagName&&"TH"!=e.target.tagName||!n.sortable||r.replace({column:t.indexOf(n),direction:e.target.classList.contains("asc")?"desc":"asc"})})}},{key:"sortDimension",value:function(t,r,n){var o=function(e){return r[n[e].column].index},a=function(e){return"desc"===n[e].direction?-1:1};t.sort(function(t,r){return 1==n.length?e.sorter(t[o(0)],r[o(0)],a(0)):e.sorter(t[o(0)],r[o(0)],a(0))||e.sorter(t[o(1)],r[o(1)],a(1))})}},{key:"sorter",value:function(e,t,r){var n=/[<>]/g;if(n.test(e)||n.test(t)){var o=document.createElement("span");o.innerHTML=e,e=o.textContent.trim();var a=document.createElement("span");a.innerHTML=t,t=a.textContent.trim()}return"object"==("undefined"==typeof e?"undefined":i(e))&&void 0!=i(e.data)&&(e=e.data),"object"==("undefined"==typeof t?"undefined":i(t))&&void 0!=i(t.data)&&(t=t.data),isNaN(e)||isNaN(t)?isNaN(parseFloat(e))||isNaN(parseFloat(t))?e.toLowerCase()<t.toLowerCase()?r:e.toLowerCase()>t.toLowerCase()?-r:0:parseFloat(e)<parseFloat(t)?r:parseFloat(e)>parseFloat(t)?-r:0:null===e?1:null===t?-1:e<t?r:e>t?-r:0}}]),e}();t.default=h,e.exports=t.default},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){r(this,e);var n=t.source,o=t.refSource,a=t.defaultHeaderRow,i=void 0===a?-1:a,l=void 0,u=void 0;if(!n)throw new TypeError("`source` table is not specified, cannot create TableColumns");return l=e.getHeader(n),o&&(u=e.getHeader(o)),e.computeColumns(l,u,i)}return o(e,null,[{key:"getHeader",value:function(e){if(e&&"TABLE"==e.tagName){var t=e.querySelector("thead");if(t&&t.children.length>0)return t;throw new TypeError("`source` table has no header or rows")}throw new TypeError("`source` is not specified or is not a table")}},{key:"getDefaultHeaderRow",value:function(e,t){var r=e.children,n=t==-1?r.length+t:t;return{index:n,row:r.item(n)}}},{key:"getHeaderCells",value:function(t,r){if(t){if(null==r)throw new TypeError("TableColumns.getHeaderCells: defaultHeaderRowIndex is not specified or is not a Number");var o=function(){for(var n=e.getDefaultHeaderRow(t,r),o=t.children,a=o.length,i={},l=function(e){var t=o.item(e),r=0;[].slice.call(t.children).forEach(function(t,n){for(var o=0;o<=t.rowSpan-1;o++){var a=i[e+o]=i[e+o]||{};if(a[r])for(var l=0;;){if(!a[l]){a[l]=t,r=l;break}l++}else a[r]=t}r+=t.colSpan})},u=0;u<a;u++)l(u);return{v:Object.keys(i[n.index]).map(function(e){return i[n.index][e]})}}();if("object"===("undefined"==typeof o?"undefined":n(o)))return o.v}return null}},{key:"computeColumns",value:function(t,r,n){var o=e.getHeaderCells(t,n),a=e.getHeaderCells(r,n),i=0;return o.map(function(e,t){var r={index:i,title:e.textContent,cell:e,colSpan:e.colSpan};return null!=a&&(r.refCell=a[t]),i=i>0?i+e.colSpan:i+1,r})}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),a=n(o),i=r(1),l=n(i);window.Reportal=window.Reportal||{},l.default.mixin(window.Reportal,{TableColumns:a.default}),t.default=a.default,e.exports=t.default},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){r(this,e);var n=t.source,o=t.refSource,a=t.defaultHeaderRow,i=void 0===a?-1:a,l=void 0,u=void 0;if(!n)throw new TypeError("`source` table is not specified, cannot create TableColumns");return l=e.getHeader(n),o&&(u=e.getHeader(o)),e.computeColumns(l,u,i)}return o(e,null,[{key:"getHeader",value:function(e){if(e&&"TABLE"==e.tagName){var t=e.querySelector("thead");if(t&&t.children.length>0)return t;throw new TypeError("`source` table has no header or rows")}throw new TypeError("`source` is not specified or is not a table")}},{key:"getDefaultHeaderRow",value:function(e,t){var r=e.children,n=t==-1?r.length+t:t;return{index:n,row:r.item(n)}}},{key:"getHeaderCells",value:function(t,r){if(t){if(null==r)throw new TypeError("TableColumns.getHeaderCells: defaultHeaderRowIndex is not specified or is not a Number");var o=function(){for(var n=e.getDefaultHeaderRow(t,r),o=t.children,a=o.length,i={},l=function(e){var t=o.item(e),r=0;[].slice.call(t.children).forEach(function(t,n){for(var o=0;o<=t.rowSpan-1;o++){var a=i[e+o]=i[e+o]||{};if(a[r])for(var l=0;;){if(!a[l]){a[l]=t,r=l;break}l++}else a[r]=t}r+=t.colSpan})},u=0;u<a;u++)l(u);return{v:Object.keys(i[n.index]).map(function(e){return i[n.index][e]})}}();if("object"===("undefined"==typeof o?"undefined":n(o)))return o.v}return null}},{key:"computeColumns",value:function(t,r,n){var o=e.getHeaderCells(t,n),a=e.getHeaderCells(r,n),i=0;return o.map(function(e,t){var r={index:i,title:e.textContent,cell:e,colSpan:e.colSpan};return null!=a&&(r.refCell=a[t]),i=i>0?i+e.colSpan:i+1,r})}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(1),u=n(l),s=(r(17),function(){function e(t){var r=this;if(o(this,e),void 0==("undefined"==typeof t?"undefined":a(t))||"TABLE"!=t.tagName)throw new TypeError("`source` must be defined and must be a table");e.wrapTable(t),this.header=e.cloneHeader(t),this.source=t,this.visible=!1,this._meta={lastScrollY:0,sourceTHEAD:t.querySelector("thead"),ticking:!1},window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,this.resizeFixed(),window.addEventListener("resize",function(){return r.resizeFixed.call(r)},!1),window.addEventListener("scroll",function(){return r.scrollFixed.call(r)},!1)}return i(e,[{key:"requestTick",value:function(e){this._meta.ticking||(requestAnimationFrame(e),this._meta.ticking=!0)}},{key:"resizeFixed",value:function(){this.requestTick(e._resizeCallback.bind(this))}},{key:"scrollFixed",value:function(){this._meta.lastScrollY=window.pageYOffset,this.requestTick(e._scrollCallback.bind(this))}}],[{key:"calcOffsetHeight",value:function(e){this._meta.tableOffsetTop=e.parentNode.offsetTop,this._meta.tableOffsetBottom=e.parentNode.offsetTop+e.offsetHeight-this._meta.sourceTHEAD.offsetHeight}},{key:"setVisibility",value:function(e,t,r){r?(t.style.display="table",e.dispatchEvent(u.default.newEvent("reportal-fixed-header-visible"))):(t.style.display="none",e.dispatchEvent(u.default.newEvent("reportal-fixed-header-hidden")))}},{key:"wrapTable",value:function(e){var t=document.createElement("div");t.classList.add("aggregatedTableContainer"),e.parentNode.appendChild(t),t.appendChild(e)}},{key:"cloneHeader",value:function(e){var t=e.cloneNode(!0);return t.classList.add("fixed"),e.parentNode.appendChild(t),[].slice.call(t.children).forEach(function(e){"TBODY"==e.nodeName&&t.removeChild(e)}),t}},{key:"_resizeCallback",value:function(){for(var t=this._meta.sourceTHEAD.querySelectorAll("tr>*"),r=this.header.querySelectorAll("thead>tr>*"),n=this.source.offsetWidth+"px",o=[],a=0;a<t.length;a++)o.push(t[a].offsetWidth);for(var i=0;i<r.length;i++)r[i].style.width=o[i]+"px";this.header.style.width=n,e.calcOffsetHeight.call(this,this.source),this._meta.ticking=!1,this.scrollFixed()}},{key:"_scrollCallback",value:function(){var t=this._meta.lastScrollY,r=this._meta.tableOffsetTop,n=this._meta.tableOffsetBottom;(t<r||t>n)&&this.visible?(this.visible=!1,e.setVisibility(this.source,this.header,!1)):t>=r&&t<=n&&(this.header.style.top=t-r+"px",this.visible||(this.visible=!0,e.setVisibility(this.source,this.header,!0))),this._meta.ticking=!1}}]),e}());t.default=s,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),c=n(s),f=r(6),d=n(f),p=r(14),h=n(p),y=r(5),m=n(y);r(19);var v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.source,n=e.rowheaders,i=e.hierarchy,u=(e.initMap,e.containerID,e.mappointCallback),s=e.excludeColumns,f=e.excludeRows,d=e.valueColumn,p=void 0===d?1:d,h=e.fullParentLevelInfo,y=void 0===h||h,m=e.colorFn,v=void 0===m?function(e,t){return null!=e?e>=80?"#4caf50":e<80&&e>=60?"#ffc107":"#ff5722":"blue"}:m,b=e.pageStateId,g=void 0===b?document.querySelector("#PageStateId")?document.querySelector("#PageStateId").value:null:b,w=e.tableID,k=e.normals,S=e.normalsSeparator,C=void 0===S?",":S,x=e.options,_=void 0===x?{}:x;o(this,t);var E=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,k,C));if(E.constructor.parseTableData({source:r,excludeRows:f,excludeColumns:s,rowheaders:n.map(function(e){return e[0]}),flatHierarchy:E.flatHierarchy}),v&&"function"==typeof v&&(E.colorFn=v),E.valueColumn=p,E.pageStateId=g,E.tableID=w,E.fullParentLevelInfo=y,u&&null!=u){if("function"!=typeof u)throw new TypeError("mappointCallback must be a function");E.mappointCallback=u}E.config=c.default.mixin(_,{});if(void 0==("undefined"==typeof Highcharts?"undefined":l(Highcharts)))throw new Error("Highcharts must be declared. Probably they are missing");if(void 0==l(Highcharts.maps))throw new Error("HighMaps must be loaded. Probably they are missing");return E}return i(t,e),u(t,[{key:"initMap",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.subcells.forEach(function(e){if(e.mapID){var n=t.composeSeries(e);r.push(n)}}),r}},{key:"getSeriesData",value:function(e){var r=this,n=e.subcells?e.text:null;if("string"==typeof e.mapID)return[{drilldown:n,code:e.mapID,value:t.getPrimaryValue(e,this.valueColumn),data:e._data}];if(Array.isArray(e.mapID))return e.mapID.map(function(o){return{drilldown:n,code:o,value:t.getPrimaryValue(e,r.valueColumn),data:e._data}});throw new Error("Data element is corrupted")}},{key:"getCoordinateSeries",value:function(e,r,n){var o=this;n.mapTransforms=r?r["hc-transform"]:Highcharts.maps["custom/world-highres2"]["hc-transform"];var a=n.fromLatLonToPoint({lat:e.coordinates[0],lon:e.coordinates[1]}),i={type:"mappoint",name:e.text,marker:{lineColor:"black",lineWidth:1,radius:4,symbol:"circle"},data:[{color:t.computeColor(this.colorFn,t.getPrimaryValue(e,this.valueColumn),e.target),name:e.text,value:e.value,x:a.x,y:a.y}]};return this.mappointCallback&&!function(){var e=o;i.events={click:function(t){e.mappointCallback.call(this,t)}}}(),i}},{key:"composeSeries",value:function(e,r,n){if(e.coordinates)return this.getCoordinateSeries(e,r,n);if(r=r?Highcharts.geojson(t.createCustomGeoJSON(r,e.mapID,e.text)):Highcharts.geojson(t.createCustomGeoJSON(Highcharts.maps["custom/world-highres2"],e.mapID,e.text)),e.mapID){var o=e.target;return o&&null!=o||(o=this.hierarchy[0].target),{name:e.text,dataLabels:{enabled:!0,formatter:function(){if(this.series.data[0]["hc-key"]==this.point["hc-key"])return this.series.name}},color:t.computeColor(this.colorFn,t.getPrimaryValue(e,this.valueColumn),o),allAreas:!1,parent:e.parent.text,mapData:r,joinBy:["hc-key","code"],data:this.getSeriesData(e)}}}},{key:"updateMap",value:function(e,r,n){var o=this;if(e&&e.mapName){var a=t.loadMap(e.mapName);a.then(function(t){o.addSeries(e,r,n,t)})}else e&&!e.mapName&&this.addSeries(e,r,n)}},{key:"addSeries",value:function(e,t,r,n){var o=this;if(e.subcells){if(e.subcells[0].coordinates){var a=this.composeSeries(e,n,t);a.data.forEach(function(e){e.drilldown=null,e.value=null}),t.addSingleSeriesAsDrilldown(r.point,a)}e.subcells.forEach(function(e){if(e.mapID||e.coordinates){var a=o.composeSeries(e,n,t);t.addSingleSeriesAsDrilldown(r.point,a)}}),t.applyDrilldown()}else{var i=this.composeSeries(e,n,t);i.data.map(function(e){e.drilldown=null,e.value=null}),t.addSeriesAsDrilldown(r.point,i)}}},{key:"getTooltip",value:function(){var e=this.curLVL._data;return e.map(function(e,t){return'<span class="tooltip-level-label">'+e.title+':</span><span class="tooltip-level-value"> {point.data.'+t+".value}</span>"}).join("<br />")}},{key:"drawMap",value:function(e,r,n,o){this.curLVL=this.flatHierarchy[e[0]];var a=this,i={lang:{drillUpText:"< to {series.parent}"},tooltip:{pointFormat:a.getTooltip()},title:{text:""},legend:{enabled:!0},plotOptions:{series:{states:{normal:{animation:!1}},point:{events:{mouseOver:function(e){this.series.data.forEach(function(e){return e.setState("hover")})},mouseOut:function(e){this.series.data.forEach(function(e){return e.setState()})}}}}},mapNavigation:{enabled:!0,buttons:{zoomIn:{verticalAlign:"bottom"},zoomOut:{verticalAlign:"bottom"}}},subtitle:{align:"right",text:a.subtitle,floating:!0},drilldown:{drillUpButton:{position:{align:"left",y:0},relativeTo:"spacingBox"}},chart:{events:{drilldown:function(e){var r=e.target;a.curLVL=t.getLevelByName(a.curLVL,e.point.series.name);var n=a.curLVL;if(n){r.showLoading("fetching data");d.default.fetchChildTable(n.id,n.parent?n.parent.id:null,a.tableID,a.pageStateId).then(function(o){t.parseTableData({source:o,excludeRows:0,rowheaders:n.subcells.map(function(e){return e.id}),flatHierarchy:a.flatHierarchy}),a.updateMap(n,r,e),r.subtitle.update({text:a.subtitle}),r.hideLoading()})}},drillupall:function(e){a.curLVL=a.curLVL.parent,a.curLVL&&e.target.subtitle.update({text:a.subtitle})}}},series:a.initMap(a.curLVL,[{showInLegend:!1,mapData:Highcharts.maps[n]}])};Highcharts.mapChart(r,c.default.mixin(i,o))}},{key:"subtitle",get:function(){return this.fullParentLevelInfo?this.curLVL._data.map(function(e){return'<span class="tooltip-level-label">'+e.title+':</span><span class="tooltip-level-value"> '+e.value+"</span>"}).join("<br />"):this.curLVL._data[0].title+": "+this.curLVL._data[0].value+"<br> "+this.curLVL._data[this.valueColumn].title+": "+this.curLVL._data[this.valueColumn].value}}],[{key:"parseTableData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.source,r=e.excludeRows,n=e.rowheaders,o=e.flatHierarchy,a=e.excludeColumns,i=new m.default({
source:t,excludeColumns:a,excludeRows:r});if(!(n&&null!=n&&n.length>0))throw new Error("rowheaders must be present to parse data");n.forEach(function(e,t){o[e]._data||(o[e]._data=i.data[t].map(function(e,t){return{value:e.data,title:0!=t?i.columns[t].title:"Region"}}))})}},{key:"createCustomGeoJSON",value:function(e,r,n){var o={title:"",version:"0.1.0",type:"FeatureCollection",copyright:"Copyright (c) 2015 Highsoft AS, Based on data from Natural Earth",copyrightShort:"Natural Earth",copyrightUrl:"http://www.naturalearthdata.com",crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG:54003"}},"hc-transform":{default:{crs:"+proj=mill +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +R_A +datum=WGS84 +units=m +no_defs",scale:172182781654e-16,jsonres:15.5,jsonmarginX:-999,jsonmarginY:9851,xoffset:-19495356.3693,yoffset:12635908.1982}},features:t.getFeatures(r,e)};return o.title=n,o}},{key:"getFeatures",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hc-key";return"string"==typeof e?t.features.filter(function(t){return t.properties[r]===e}):Array.isArray(e)?t.features.filter(function(t){return e.indexOf(t.properties[r])!=-1}):void 0}},{key:"loadMap",value:function(e){return new Promise(function(t,r){jQuery.getScript("https://code.highcharts.com/mapdata/"+e+".js",function(){t(Highcharts.maps[e])})})}},{key:"getPrimaryValue",value:function(e,t){return e._data[t].value}},{key:"computeColor",value:function(e,t,r){return e?e(t,r):void 0}},{key:"getLevelByName",value:function(e,t){return e.subcells.filter(function(e){return e.text==t})[0]}}]),t}(h.default);t.default=v,e.exports=t.default},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t,n,o){r(this,e),this.flatHierarchy=t,this.hierarchy=this.constructor.processHierarchy(this.flatHierarchy,n,o),this.constructor.addMapIDsToHierarchyLevel(this.hierarchy)}return n(e,null,[{key:"processHierarchy",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:",",[]),o=Object.keys(r).length>0;for(var a in t){var i=t[a];o&&e.normalize(i,r),i.parent&&null!=i.parent&&i.parent.length>0?(i.parent=t[i.parent],i.parent.subcells=i.parent.subcells||[],i.parent.subcells.push(i)):n.push(i)}return n}},{key:"composeFlatHierarchy",value:function(t,r){var n={},o=r.keys().length>0;return t.forEach(function(t){o&&e.normalize(t,r),n[t.id]=t}),n}},{key:"normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",",n={stringArray:function(e){return e.split(r)},numberArray:function(e){return e.split(r).map(function(e){return parseFloat(e)})},string:function(e){return e.trim()},number:function(e){return null==e||isNaN(parseFloat(e))?null:parseFloat(e)},boolean:function(e){return"true"==e.toLowerCase()||"1"==e}};for(var o in t)e[o]&&(e[o].length>0?e[o]=n[t[o]](e[o]):delete e[o])}},{key:"addMapIDsToHierarchyLevel",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.forEach(function(t){t.parent&&null!=t.parent&&t.parent.mapName&&(t.mapName=t.parent.mapName),t.subcells&&e.addMapIDsToHierarchyLevel(t.subcells,t),t.parent&&t.mapID&&!t.parent.mapName&&(t.parent.mapID||(t.parent.mapID=[]),t.parent.mapID=t.parent.mapID.concat(t.mapID))})}}]),e}();t.default=o,e.exports=t.default},function(e,t){},function(e,t){},function(e,t){},,function(e,t){}]);
//# sourceMappingURL=drilldown-nps-map.bundle.js.map